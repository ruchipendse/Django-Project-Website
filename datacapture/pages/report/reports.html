{% extends 'base.html' %}
{% block content_2 %}
    {% if not user.is_authenticated %}
        <script>
            window.location.href = "/";
        </script>
    {% endif %}

    <meta id="allTimeSheetEntriesJsondata" data="{{allTimeSheetEntriesJson}}" />
    
    <h1>Electral Control Systems</h1>
    <h2>Reports: IN PROGRESS</h2>

    <div class = "reports"> 
        <form name = "reportsForm" action = "reports" method = "POST">
            {% csrf_token %} 
            <input type = "hidden" id = "selectedCriteria" name = "selectedCriteria" value = "USER"/>
            <div id = 'date_div' align = 'left'>
                <table>
                    <tr>
                        <td><label id="label_from_date" for = "from_date" disabled>From</label></td>
                        <td><input type = "date" name = "from_date" id = "from_date"></td>
                        <td><label id="label_to_date" for = "to_date" disabled>To</label></td>
                        <td><input type = "date" name = "to_date" id = "to_date" value = '{{selected_date}}''></td>
                        <td><label id="label_criteria" for = "criteria" disabled>Criteria</label></td>
                        <td>
                            <select id = "report_criteria" name = "report_criteria"  style="min-width:100%;">
                                <option value = "USER">User</option>
                                <option value = "MACHINE">Machine</option>
                                <!-- <option VALUE = PART"">Part</option> -->
                            </select>
                        </td>
                        <td>
                            <input type="submit" id = "generateReport" class="w3-button w3-blue" value=" Generate Report"
                                    onclick = "setFunctionMode('GENERATE')">
                        </td>
                    </tr>
                </table>
            </div>
            <table id = "report_table"  width = 95% border = 1>
                <tr>
                    <th  width="20%">Date</th>
                    <th  width="20%">Prod (min)</th>
                    <th  width="20%">Non-Prod (min)</th>
                    <th  width="20%">Parts expected</th>
                    <th  width="20%">Parts actual</th>
                    <!-- <th  width="auto%"></th> -->
                </tr>
                    {% for key, value in allTimeSheetEntries.items %}
                    <tr>
                        <td>{{key}}</td>
                        <td>{{value.total_time_prod_mins}}</td>
                        <td>{{value.total_time_nonprod_mins}}</td>
                        <td>{{value.total_parts_finished_expected}}</td>
                        <td>{{value.total_parts_finished_actual}}</td>
                    </tr>
                {% endfor %}
            </table>
        </form>
    </div>

<script>

    function setFunctionMode(fMode){
        document.getElementById('functionMode').value =  fMode;
    }

    function setupSelected(st){
        document.getElementById('editSetupButton').classList.remove('disabled');
        document.getElementById('deleteSetupButton').classList.remove('disabled');
        document.forms["setupsForm"]['selectedSetup'].value = st;

        var setupsListJson = document.getElementById('setupsListJsondata').getAttribute("data");
        var setupsList = JSON.parse(setupsListJson);

        document.getElementById('scode').setAttribute('value', setupsList[st]['id_code'])
        document.getElementById('sname').setAttribute('value', setupsList[st]['name'])
        document.getElementById('sdesc').setAttribute('value', setupsList[st]['desc'])
    }

    /**
        THIS METHOD INITAITES THE STATUS OF REQUIRED FIELDS ON USERS PAGE 
    */
    function init(){
    }

    init();
</script>
{% endblock %}
